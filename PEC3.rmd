---
title: "PEC3"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Sección 1 (8 puntos) 

**1. (0,5 puntos)  Buscad un conjunto de datos relacionados con la Bioestadística o Bioinformática. Para ello, podéis utilizar algunos recursos conocidos como es el caso de http://www.bioinformatics.org/sms2/index.html o de http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets.  **
**También podéis utilizar otros recursos propios que conozcáis o que sean de vuestro interés, y siempre teniendo en cuenta que sean datos públicos que podéis utilizar.  Tenéis que explicar la procedencia de los datos así como incluir las referencias que correspondan y justificar porqué habéis elegido estos datos.**

Una comprensión holística de los fenómenos ecológicos implica reducir la complejidad natural en factores y relaciones interpretables. Este reduccionismo viene facilitado por la elaboración de modelos matemáticos, que permitan la comprensión de dichos fenómenos, la obtención de conclusiones y la elaboración de predicciones. Típicamente, los sistemas ecológicos han sido clasificados atendiendo a su dinámica en sistemas en equilibrio y sistemas en no-equilibrio, de tal manera que aquellos cambios reversibles pertenecerían a un sistema en equilibrio, y los cambios no reversibles a los sistemas en no-equilibrio. El aumento de la capacidad computacional ha permitido durante las dos últimas décadas abordar modelos multinivel más complejos, que, si bien eran conocidos, no eran aplicables debido una insuficiente capacidad de cálculo. Estos nuevos enfoques determinan que las dinámicas ecológicas están englobadas en un continuo equilibrio, no-equilibrio; en vez de dos estados contrapuestos.
Las llanuras de Rehoboth, en Namibia central, han permitido a algunos investigadores desarrollar estos nuevos modelos. Esta región semi-árida de estepa y poca vegetación, ha sido durante cientos de años, y sigue siendo hoy en día, zona de pastoreo. A pesar de su contribución reducida al Producto Interior Bruto (PIB), la agricultura es un sector que se mantiene como fundamental para la mayoría de la población (algo más de dos millones de habitantes en 2019). De forma directa o indirecta, mantiene aproximadamente al 70% de la población del país.  [http://www.fao.org/namibia/fao-in-namibia/namibia-at-a-glance/en/]. La elaboración de modelos que permitan realizar una explotación óptima de la estepa, a la vez que mantienen la dinámica de los pastizales, puede suponer enormes beneficios sobre la economía y salud de las personas.
Nuestra atención se centra sobre el estudio elaborado por [], y los datos obtenidos a partir de este (que se pueden encontrar en []). Este estudio emplear un conjunto jerárquico de modelos ecológicamente significativos con una complejidad creciente, el enfoque HOF (Huisman – Olff – Fresco), para investigar las respuestas de pastoreo de las especies, los parámetros de diversidad y los valores de cobertura agrupados para dos rasgos: forma de crecimiento y ciclo de vida.



**2. (0,5 puntos) Utilizando R, mostrad y explicad qué tipo de fichero habéis importado y las variables que forman parte de él (tipo, clasificación,...), así como todo aquello que creáis relevante. Incluir capturas de pantalla y las instrucciones en R que habéis utilizado para importar y  mostrar los datos.** 

Hemos utilizado un dataset que pertenece al paquete de R llamado ade4.  La manera de importar es con la función *data* del paquete base de R. En este caso no es necesario que utilizar funciones como read.delim, read.csv o read.table de las utilidades de R que son las habituales para importar ficheros de texto, o la función read.xlsx de la librería xlsx para importar ficheros en formato excel, o read.spss del paquete foreign para leer ficheros procedentes del paquete estadístico SPSS.

La particularidad de este dataset es que viene definido a través de un objeto *lista* llamado *piosphere*. 
Este objeto lista está formado a su vez por cuatro objetos

<!-- La presión que ejercen los animales sobre los recursos, no se presenta -->
<!-- uniformemente a lo largo del lote, esta ampliamente aceptado que la presión es -->
<!-- mayor cerca de los puntos en donde los animales se reúnen a beber. Lange -->
<!-- (1969) emplea el termino “piosfera” para describir esta relación entre las -->
<!-- aguadas y los animales en pastoreo. Por lo tanto se entiende como piosfera al -->
<!-- sitio que rodea los puntos de bebidas en donde la presión por pastoreo sobre el -->
<!-- suelo y la vegetación, es muy intensa y esta presión disminuye con distancias -->
<!-- crecientes a los puntos de bebida.  -->

- Data frame que se llama **veg** que tiene la información sobre la proporción de cada  cada una de las especies en la superficie superior de la vegetación. Cada una de las filas se corresponde a los datos de las piosferas elegidas. Tenemos 378 piosferas y 87 tipos de especies.
- Data frame que se llama **traits** que tiene la información de las características o rasgos de las plantas. Cada una de las filas se corresponde a los valores de las columnas del data frame **veg**. Es decir en este data frame tendremos 87 filas y 21 características
- Data frame que se llama **env** que contiene la información de variables medioambientales relativas a las 378 piosferas que se han estudiado. Se han recopilado 25 variables
- Vector llamado **habitat** es una variable tipo factor que describe el tipo de habitat de cada una de las piosferas.

```{r carga_librerias,echo=T, message=F, warning=F,comment=F}
require(ade4)
library(ade4)
library(dplyr)
library(ggplot2)
library(kableExtra)
library(captioner)
library(ade4)
ind.tabla<-1
ind.figura<-0
table_nums <- captioner(prefix = "Tabla.")
```


```{r echo=T, message=F, warning=F,comment=F}
data("piosphere")
```


```{r echo=F}
tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
piosphere$veg %>% head() %>% kable(caption = paste0(tab.1_cap,"Primeras seis filas de Data Frame veg")) %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)

tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
piosphere$veg %>% tail() %>% kable(caption = paste0(tab.1_cap,"Últimas seis filas de Data Frame veg")) %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)
```

```{r echo=F}
tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
piosphere$traits %>% head() %>% kable(caption = paste0(tab.1_cap,"Primeras seis filas de Data Frame traits")) %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)
```


```{r echo=F}
tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
sapply(piosphere$traits,class)%>% kable(caption = paste0(tab.1_cap,"Clasificación de las variables que definen los rasgos de las especies"),col.names = "Tipo de Variable") %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)
```


```{r echo=F}
tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
piosphere$env %>% head() %>% kable(caption = paste0(tab.1_cap,"Primeras seis filas de Data Frame env")) %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)

tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
sapply(piosphere$env,class)%>% kable(caption = paste0(tab.1_cap,"Clasificación de las variables que definen las variables medioambientales recogidas"),col.names = "Tipo de Variable") %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)
```

```{r echo=F}
tab.1_cap<-table_nums(name=paste0("tab",ind.tabla))
piosphere$habitat %>% head() %>% kable(caption = paste0(tab.1_cap,"Primeros seis elementos de Vector habitat"),col.names = "Tipo de Habitat") %>% kable_styling()
ind.tabla <- increment(ind.tabla,1)
```


**3. (1,5 puntos) Realizad un mínimo de seis preguntas objetivo que den una idea de la información contenida en el conjunto de datos escogido, es decir, obtener información del conjunto de datos a partir de determinados criterios, según variables, o rangos de valores, etc... Para ello, podéis basaros en el tipo de consultas realizadas en la PEC1 y también utilizando, en alguno de los casos, la definición de funciones tal como se trabaja en el LAB3.**

- Se me ocurre mostrar el porcentaje de especies que tienen datos en cada una de las piosferas
    - A colación de este, las diferencias porcentuales que puede haber entre las ST y las LT.

- Mostrar la especie mayoritaria en cada una de las especies o sacar las caracteristicas relacionadas con dicha especie
  para cada piosfera

- Mostrar la especie que tiene el valor maximo para cada una de las caracteristicas del data.frame traits
- Mostrar cuantas especies cuyo ciclo vital es anual tienen consistencia de hoja mesomorfica suave

- Mostrar que piosferas tienen mayor inclinacion de la media

- Mostrar que piosferas tienen valores nitritos, nitratos y phosphatos por encima del 75%
    - A colación de este, mostrar la distribución de pH, a que piosferas pertenecen la correlación con los nutrientes.
      (ej6)



**4. (1,5 puntos) Realizad un análisis descriptivo de los datos. Este estudio debe incluir, un resumen paramétrico de los datos y diversas representaciones gráficas de los mismos basadas en determinados criterios. Dejamos a vuestra elección el tipo de gráficos y los criterios utilizados.**



#PROPORCIONES, TASAS, RAZONES Y PROMEDIOS.
#resumen paramétrico de los datos: Procedimiento frecuencias, procedimiento descriptivos.
#gráficas 

Obtenemos los data frames
```{r}
veg <- piosphere$veg
traits <- piosphere$traits
env <- piosphere$env
```



#Con respecto al df veg, previo al análisis paramétrico es necesario tratar los datos.
#No se me ocurre una alternativa a agrupar las diferentes subáreas.
#Esta es mi propuesta:
 
```{r}
split(veg,sub("-.*","",data$V1))

```



Para el data frame **traits** nos vamos a centrar en algunas de las variables que nos parecen significativas en su contexto ecológico.

Proporciones y parámetros de centralidad y dispersión para diferentes variables (*height*, *leaf traits*, *diaspore length*, *life cycle*) nos van a proporcionar una visión intuitiva del conjunto de especies englobadas en nuestra base de datos, e incluso, sobre las características del bioma al que pertenecen. 

#No he conseguido encontrar referencias al significado de las variables SLA y CDA

Variable *height*
```{r cuatro_traits}
#Proporciones
attach(traits)
range(height)
quantile(height)


#Medidas de centralidad y dispersión
mean(height)
median(height)
sd(height)


#Histograma
ggplot(data=traits, aes(x=traits$height)) + 
  geom_histogram(breaks=seq(0, 400, by=50), 
                 col="black", 
                 fill="steelblue", 
                 alpha = .6) + 
  labs(title="Histograma para las alturas", x="Altura", y="Frecuencia")
```


Variable *diaspore length*
```{r cuatro_traits, warning=FALSE}
#Proporciones
attach(traits)
range(diaspore.length)
quantile(diaspore.length)


#Medidas de centralidad y dispersión
mean(diaspore.length)
median(diaspore.length)
sd(diaspore.length)


#Histograma en log
ggplot(data=traits, aes(x=log(traits$diaspore.length))) + 
  geom_histogram(col="black", 
                 fill="darkgreen", 
                 alpha = .6,
                 binwidth=0.5) + 
  labs(title="Histograma para la longitud de las diásporas", x="Longitud de la diáspora", y="Frecuencia")


#Boxplot en log
ggplot(data=traits, aes(x=log(traits$diaspore.length))) + 
  geom_boxplot(col="black", 
                 fill="darkgreen", 
                 alpha = .6,
                 binwidth=5) + 
  labs(title="Histograma para la longitud de las diásporas", x="Longitud de la diáspora", y="Frecuencia")
```



```{r cuatro_traits}
#Frecuencias
table(traits$life.cycle)
table(traits$life.cycle)/sum(table(traits$life.cycle))
```





```{r cuatro_env}



```



```{r cuatro_env}



```



**5. (1 punto) Realizad, basándoos en los conceptos trabajados en el LAB4 y PEC2, un mínimo de tres enunciados que respondan a una cuestión de probabilidad y un mínimo de un enunciado que corresponda a un breve modelo de simulación. En este caso, si vuestro conjunto de datos no propicia estos enunciados, podéis generar una o diversas distribuciones en base a unos parámetros determinados definidos por vosotros. **



**6. (1 punto) Realizad un breve análisis de regresión (lineal y múltiple) a partir de las variables que disponéis y utilizando el criterio que responda a alguna pregunta de interés que os hayáis planteado.**



**7. (1 punto) A partir del conjunto de datos que estáis trabajando, plantead un estudio ANOVA y desarrollado si, a partir del estudio previo, se cumplen las condiciones.**

**8. (1 punto) A partir de los datos de origen y el estudio realizado, haced una valoración final. Para ello, podéis basaros en las siguientes preguntas: "disponemos de conclusiones finales?", "sería necesario hacer un análisis más avanzado?", "faltan datos para obtener otro tipo de información como...?",.... **


# Sección 2 (2 puntos) 
Como habréis comprobado, las aplicaciones y herramientas de R son muy amplias. En esta sección, tenéis que definir y desarrollar un ejemplo de aplicación de uno de los  temas que aparecen a continuación. 

Podéis basaros en la información referenciada de la plataforma Datacamp, a la cual tenéis acceso con vuestro correo electrónico de la UOC, o cualquier otra fuente de información que consideréis más oportuna.

Sería conveniente, que el ejemplo a desarrollar sea basado en la fuente de datos de la Sección 1, pero también podéis basaros en otro conjunto de datos.

Los temas a escoger son:
- Construcción de una aplicación web con Shiny 
- Análisis cluster con R 
- Repositorio Bioconductor en R 
